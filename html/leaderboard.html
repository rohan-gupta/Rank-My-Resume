<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"></script>
</head>
<body>
<div class="ui container" style="margin-top: 30px;">
    <!-- Menu -->
    <div class="ui primary menu">
        <a class="item"><h3>Rank My Resume</h3></a>
        <a class="item" href="./index.html">Home</a>
        <a class="item" href="./leaderboard.html">Leaderboard</a>
    </div>

    <!-- Leaderboard Header -->
    <h2 class="ui header">Leaderboard</h2>

    <!-- Leaderboard Table -->
    <table class="ui celled striped table">
        <thead>
            <tr>
                <th>Rank</th>
                <th>Username</th>
                <th>Job Org</th>
                <th>Job ID</th>
                <th>Score</th>
            </tr>
        </thead>
        <tbody id="leaderboardBody">
            <!-- Rows will be dynamically populated -->
        </tbody>
    </table>
</div>

<script>
    async function fetchLeaderboard() {
        const endpoint = "https://ft776g0b88.execute-api.us-east-1.amazonaws.com/leaderboard";

        try {
            const response = await fetch(endpoint, {
                method: "GET",
                headers: {
                    "Content-Type": "application/json"
                },
            });

            if (!response.ok) {
                throw new Error(`Failed to fetch leaderboard. HTTP status: ${response.status}`);
            }

            const leaderboardData = await response.json();

            console.log(leaderboardData)

            const leaderboardBody = document.getElementById("leaderboardBody");
            leaderboardBody.innerHTML = "";

            leaderboardData.forEach((entry, index) => {
                const row = `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${entry.username}</td>
                        <td>${entry.jobOrg}</td>
                        <td>${entry.jobId}</td>
                        <td>${entry.score}</td>
                    </tr>
                `;
                leaderboardBody.innerHTML += row;
            });
        } catch (error) {
            console.error("Error fetching leaderboard:", error);
        }
    }

    // Fetch and render leaderboard data on page load
    document.addEventListener("DOMContentLoaded", fetchLeaderboard);
</script>
</body>
</html>
